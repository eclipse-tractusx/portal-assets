# User Description

How to connect the own idp:  
<br>

- Request a idp connection
- Upload your company-idp metadata file (please note, CX will mainly support OIDC)
- Manually add client-id and secret
- Confirm the IdP config, we will share the authentication URL with you

<br>

After successful setup, the user migration/invite need to take place, before the previous used idp is getting deactivated and deleted.

<br>

Details regarding the IAM architecture (applies for shared as well as own IdP usage)

<br>
<br>

<p align="center">
<img width="807" alt="image" src="https://user-images.githubusercontent.com/94133633/214049654-04efcc10-fcab-4b56-a3a2-0285c2ee9c0a.png">
</p>

<br>
<br>

### Register your company IdP

To register your company idp, login with administration rights and open the "Identity Provider Config" via the top right user navigation.
Inside the config, you will find your current registered (enabled and disabled) identity providers - quite often this will only be one identity provider. As well as the option to register a new identity provider (such as you company idp).

<br>
<br>

<p align="center">
<img width="836" alt="image" src="https://user-images.githubusercontent.com/94133633/218339032-e28f6325-fb79-4517-b2b3-f761b1d6d278.png">
</p>

<br>
<br>

    Please note - for the company identity provider connection you will need to prepare certain information to be able to connect your company IdP. Please ensure that all necessary information are available.

Currently only the connection for OIDC idp's is supported.

<br>
<br>

#### Create the new idp record

Click on "Add Identity Provider" to start the registration.
Inside the overlay the

- idp display name - used for the login company card (users which try to login to CX will see this display name. Use a name which users can understand and know that this belongs to their company)
- identity provider type - "managed" for onboarding service provider/3rd party acting company and "own" for company owned IdPs
  <br>

<p align="center">
<img width="680" alt="image" src="https://github.com/catenax-ng/tx-portal-assets/assets/94133633/59a5444f-c789-4d0f-8473-9618983bd711">
</p>

<br>

By clicking on "Confirm".

On the upcoming screen the idp relevant connection information need to get added.
Those are

- metadata url (available in your local/company IdP - ending with /.well-known/openid-configuration)
- client ID (created in your company IdP)
- client secret (created in your company IdP)
  <br>

<p align="center">
<img width="683" alt="image" src="https://github.com/catenax-ng/tx-portal-assets/assets/94133633/e98d5fa8-9fe4-4200-af31-8c1fa4cd3586">
</p>

<br>

if the config was successful, you will get asked to add your personal company idp unique identifier. In this step you will connect your existing catena-x user account (with your already assigned roles and customized configurations) with your company IdP. To do this successfully, you need to add your company IdP unique ID.  
<br>

<p align="center">
<img width="682" alt="image" src="https://github.com/catenax-ng/tx-portal-assets/assets/94133633/1aed7ae6-d88c-4165-a9f1-2a42ff35d8c8">
</p>

<br>

With the confirm/submit button the value will get stored successfully and you can now test the company IdP integration by doing a logout and trying to login with your company credentials and company IdP.
Please note: in this moment, your user is connected with the Catena-X Shared IdP as well as your company IdP. This means, if after the logout and new login via your company IdP you might find out, that the login via the company IdP might not work (due to wrong configuration) you still can login to catena-X with the previous used IdP and correct the IdP config.  
<br>

<p align="center">
<img width="684" alt="image" src="https://github.com/catenax-ng/tx-portal-assets/assets/94133633/bf670818-6fab-4a75-8ace-afad4e0132ab">
</p>

<br>
<br>

Connected Content: [User Migration New IdP](/docs/02.%20Technical%20Integration/02.%20Identity%20Provider%20Management/03.%20User%20Migration.md)

## NOTICE

This work is licensed under the [Apache-2.0](https://www.apache.org/licenses/LICENSE-2.0).

- SPDX-License-Identifier: Apache-2.0
- SPDX-FileCopyrightText: 2021-2023 Contributors to the Eclipse Foundation
- Source URL: https://github.com/eclipse-tractusx/portal-assets
