## Service Subscription Activation

<br>
<br>

Links:

[EndUser Docu](</docs/05.%20Service(s)/03.%20Service%20Subscription/03.%20Service%20Subscription%20Activation%20(Provider).md>)
[FAQ](</docs/05.%20Service(s)/03.%20Service%20Subscription/05.%20FAQ.md>)

<br>
<br>

## Implementation

<br>

### Activation Overlay

<br>
<p align="center">
<img width="811" alt="image" src="https://github.com/catenax-ng/tx-portal-assets/assets/94133633/251c51d8-9d2a-413c-8e11-6df3f4f57a49">
</p>
<br>

Depending on the technical user profile flag inside the endpoint

```diff
GET: /api/services/provided/subscription-status

{
 ...
  "technicalUser": "true/false"
 ...
}

```

the respective overlay will be shown.

<br>

To be able to display all the necessary content of the overlay, additionally the endpoint GET: /api/services/servicerelease/{serviceId}/technical-user-profiles need to get fetched to retrieve the service technical user profile.

<br>
<br>

### Activation & Success

With the click on the "Confirm" button - the endpoint "autosetup" is triggered.

```diff
POST: /api/services/autoSetup

{
  "requestId": "uuid - subscriptionId",
  "offerUrl": "string"
}

```

<br>

##### Data Mapping:

- requestId: {subscriptionId}
- offerUrl: currently hardcoded

<br>

> **_NOTE:_** The offerUrl is planned to get removed from the endpoint request body asap.

> **_NOTE:_** The endpoint POST: /api/services/autoSetup can only get triggered by the service owner and if the service subscription record is in state "PENDING"

<br>

##### Result

<br>
<p align="center">
<img width="823" alt="image" src="https://github.com/catenax-ng/tx-portal-assets/assets/94133633/99da0893-5711-4436-8234-b331c0004fdf">
</p>
<br>

If the technicalUser flag is "true" the FE business logic will display the respective data (displayed inside the overlay) provided as response of the /autosetp endpoint.

```diff
POST: /api/services/autoSetup

{
  "technicalUserInfo": {
    "technicalUserId": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
    "technicalUserPermissions": [
      "string"
    ],
    "technicalUserSecret": "string",
    "technicalClientId": "string"
  },
  "clientInfo": {
    "clientId": "string",
    "clientUrl": "string"
  }
}

```

<br>

##### Data Mapping:

- technicalUserId: {UserID}
- technicalUserSecret: {secret}
- clientUrl: {URL}
- technicalUserPermissions: {technicalUserType}

<br>
<br>
